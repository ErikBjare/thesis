% Uncomment to use official LTH thesis template
\def\UseCSLTH{true}

\ifx\UseCSLTH\undefined
    \documentclass[a4paper]{article}
\else
    \documentclass[nofilelist]{cslthse-msc}
\fi

% Based on templates:
%  - http://www.maths.lth.se/matematiklth/exjobb/exjobbarresurs/index.html
%  - https://bitbucket.org/flavius_gruian/msccls/

\usepackage[smartEllipses]{markdown}  % For markdown
\def\markdownOptionOutputDir{build}  % Needed, see https://github.com/Witiko/markdown/issues/6#issuecomment-328699108

\usepackage[dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage{comment}
\usepackage{xargs}
\usepackage{verbatim}
\usepackage{subfig}
\usepackage{booktabs}
\usepackage{changepage}
\usepackage[bottom]{footmisc}
\usepackage[colorinlistoftodos, prependcaption, textsize=tiny]{todonotes}

% Add subsubsubsection
% As per https://tex.stackexchange.com/a/60212/36302
\usepackage{titlesec}
\setcounter{secnumdepth}{4}
\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% Ensures floats stay in their section
\usepackage[section]{placeins}

% Code snippets
\usepackage[outputdir=build]{minted}
\usemintedstyle{vs}

\usepackage[english]{datetime2}
\DTMnewdatestyle{dashdate}{%
  \renewcommand{\DTMdisplaydate}[4]{\number##1-\DTMenglishshortmonthname{##2}-\number##3}%
  \renewcommand{\DTMDisplaydate}{\DTMdisplaydate}%
}
\DTMsetdatestyle{iso}

% From: https://tex.stackexchange.com/a/178806/36302
\newcommandx{\add}[2][1=]{\todo[linecolor=red, backgroundcolor=red!25, bordercolor=red, inline, #1]{\textbf{Add:} #2}}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red, backgroundcolor=red!25, bordercolor=red, #1]{\textbf{Unsure:} #2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue, backgroundcolor=blue!25, bordercolor=blue, #1]{\textbf{Change:} #2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen, backgroundcolor=OliveGreen!25, bordercolor=OliveGreen, #1]{\textbf{Info:} #2}}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=Plum, backgroundcolor=Plum!25,bordercolor=Plum, #1]{\textbf{Improve:} #2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable, #1]{#2}}

% Formatting
\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}

% Encoding and languages
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}        % För svenska bokstäver
%\usepackage[swedish]{babel}    %Svenska skrivregler och rubriker

% Graphics
\usepackage{epsfig}
%\usepackage[dvips]{graphics}

\newcommandx{\orcid}[1]{\href{https://orcid.org/#1}{\includegraphics[width=0.7em]{img/orcid-icon.png}}}

\newcommand\myshade{85}
\colorlet{mylinkcolor}{violet}
\colorlet{mycitecolor}{YellowOrange}
\colorlet{myurlcolor}{Aquamarine}

\hypersetup{%
  linkcolor  = black, %mylinkcolor!\myshade!black,
  citecolor  = mycitecolor!\myshade!black,
  urlcolor = myurlcolor!\myshade!black,
  colorlinks = true,
}

% wide page for side by side figures, tables, etc
\newlength{\offsetpage}
\setlength{\offsetpage}{1.0cm}
\newenvironment{widepage}{\begin{adjustwidth}{-\offsetpage}{-\offsetpage}%
    \addtolength{\textwidth}{2\offsetpage}}%
{\end{adjustwidth}}

% References
\usepackage[backend=biber, style=numeric, sorting=none]{biblatex}
\usepackage{cleveref}
\bibliography{zotero}
\bibliography{misc}
\DeclareBibliographyCategory{cited}
\AtEveryCitekey{\addtocategory{cited}{\thefield{entrykey}}}

\defbibheading{notcited}{\section*{Further Reading}}

\def\mytitleen{Classifying brain activity using electroencephalography and automated time tracking}
\def\mytitlesv{Klassificering av hjärnaktivitet med elektroencephalografi och automatiserad tidsspårning}

\ifx\UseCSLTH\undefined
    \title{%
        \small DRAFT \today \\
        \small The latest version is available at \href{https://erik.bjareholt.com/thesis/thesis.pdf}{erik.bjareholt.com/thesis/thesis.pdf}\\
        \large --- \\
        \large \par M.Sc. Thesis\\
        \huge \mytitleen\\
    }
    \author{Erik Bjäreholt \orcid{0000-0003-1350-9677} \\(erik@bjareho.lt, dat13ebj@student.lu.se)}
    \date{\today}
\else
    \title{\mytitleen}
    \svensktitel{\mytitlesv}
    \subtitle{Subtitle in progress}

    \date{\today}
    %\date{January 16, 2015}

    \student{Erik Bjäreholt}{erik@bjareho.lt}

    \company{RISE}
    \supervisor{Markus Borg, \href{markus.borg@cs.lth.se}{\texttt{markus.borg@cs.lth.se}}}
    \examiner{Elizabeth Bjarnarson, \href{mailto:elizabeth.bjarnason@cs.lth.se}{\texttt{elizabeth.bjarnason@cs.lth.se}}}

    %\geometry{showframe}

    \thesisnumber{LU-CS-EX: 2023-79} % Magic Number! Do not change unless Birger Swahn asks you to do so!
    % default is Master. Uncomment the following for "kandidatarbete"/Bachelor's thesis
    %\thesistype{Bachelor}{Kandidatarbete}

    %\onelinetitle
    %\twolinestitle
    \threelinestitle
    %\fourlinestitle

    \theabstract{\input{content/0-abstract}}

    \acknowledgements{\input{content/99-acknowledgements.tex}}

    \keywords{electroencephalography, brain computer interfaces, time tracking, code comprehension, productivity, MSc}
\fi

\begin{document}

\makefrontmatter

\tableofcontents

\listoftodos[Notes \& TODOs]

\pagebreak
\begin{refsection}

\input{content/9-preface}
%\pagebreak

\input{content/1-introduction}
%\input{content/2-background}
\input{content/3-theory}
\input{content/4-method}
\input{content/5-results}
\input{content/6-conclusions}
\input{content/7-discussion}

\section{Other contributions}

    As part of the work on this thesis I've contributed several improvements to the open source projects used, including muse-lsl, moabb, eeg-notebooks, and pyRiemann.

    \begin{itemize}
        \item \href{%
                https://github.com/search?q=org%3ANeuroTechX+is%3Apr+sort%3Aupdated-desc+author%3AErikBjare
            }{PRs to NeuroTechX repos} (eeg-notebooks, moabb) (22)
        \item \href{%
                https://github.com/search?q=org%3Aalexandrebarachant+is%3Apr+sort%3Aupdated-desc+author%3AErikBjare
            }{PRs to Alexandre Barachant repos} (muse-lsl, pyRiemann) (4)
        \item \href{%
                https://github.com/search?q=org%3Abraindecode+is%3Apr+sort%3Aupdated-desc+author%3AErikBjare
            }{PRs to the braindecode repo} (1)
    \end{itemize}

\section*{Acknowledgements}

\input{content/99-acknowledgements.tex}


% References
%\bibbysegment{}
\printbibliography[category=cited]

% Further reading (uncited)
\nocite{*}
\defbibenvironment{bibnonum}
  {\list{}
     {\setlength{\leftmargin}{\bibhang}%
      \setlength{\itemindent}{-\leftmargin}%
      \setlength{\itemsep}{\bibitemsep}%
      \setlength{\parsep}{\bibparsep}}
  }
  {\endlist}
  {\item}
\printbibliography[notcategory=cited, env=bibnonum, heading=notcited]

\end{refsection}
\end{document}
